# RP2040

## Debugprobe Firmware (formely Picoprobe)

Download 'debugprobe_on_pico.uf2' from [releases](https://github.com/raspberrypi/debugprobe/releases).

No drivers necessary on Windows 11, but for container development you will need [usbipd-win](https://learn.microsoft.com/en-us/windows/wsl/connect-usb):

```ps
winget install --interactive --exact dorssel.usbipd-win
```

Share the Debugprobe with WSL via:

```ps
# Older 'interface/picoprobe.cfg' is 2e8a:0004
# Newer 'interface/csmis-dap.cfp' is 2e8a:000c
sudo usbipd bind --hardware-id 2e8a:000c
usbipd attach --auto-attach --hardware-id 2e8a:000c --wsl
```

And add the following to your devcontainer.json:

```json
    "runArgs": [
        "--privileged",             // Required to access Picoprobe SWD from dev container
        "--device=/dev/ttyACM0"     // Expose Picoprobe URT to dev container
    ],
    
    // TODO: Figure out how to connect to Picoprobe as a non-root user.
    //       Maybe https://github.com/robotdad/piconotes?tab=readme-ov-file#setup-udev-rules-in-wsl?
    "remoteUser": "root"
```

## Notes

https://github.com/jfredine/wsl_pico_setup

## Oscillator

With a 1K resistor, YSX321SL requires XOSC workaround:
```cmake
# EconoPET 40/8096 Rev. A: xosc requires a little extra time to stabilize.
# On tested sample (45240-60), 8ms was intermittent and 16ms was reliable.
# 64ms provides a large tolerance.
target_compile_definitions(${PROJECT_NAME} PUBLIC PICO_XOSC_STARTUP_DELAY_MULTIPLIER=64)
```

Anecdotally, [this project](https://github.com/Swyter/psdaptwor/tree/master) claims that 100 ohm + 33pF is "known good".  (4-layer)
